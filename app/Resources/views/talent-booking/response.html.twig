{% extends 'base.html.twig' %}

{% block home_header %}{% endblock %}

{% block body %}
  <div class="request-container head-req">
    <img src="/img/detail-bg.jpg" alt="image" class="img-responsive max-320"/></div>
    <img src="/img/detail-bg-rwd.jpg" alt="image" class="img-responsive min-320"/></div>
  <div class="container request-container reply-page">
    {{ form_start(form, { 'attr': { 'id': 'response' } }) }}
    <div class="row question">
        <div class="col-xs-12">
            <h1>Anfrage bearbeiten</h1>
            <p class="text-bold">Reagiere auf die Anfrage</p>
            <p>
                {% if inquiry.user %}{{ inquiry.user.name }}{% else %}{{ inquiry.name }}{% endif %}
                möchte dein Angebot für den unten genannten Zeitraum buchen.</p>
            <div class="{% if talent.requestPrice == 1 %}col-sm-6{% else %}col-sm-12{% endif %} reply-select">
                {{ form_widget(form.status, { 'attr': { 'class': 'selectpicker', 'title': 'BITTE AUSWÄHLEN*' } }) }}
                <div class="err-msg">'{{ form_errors(form.status) }}</div>
              </div>
            {% if talent.requestPrice == 1 %}
                <div class="col-sm-6 preisauf">
                    <label for="form[price]">Gesamtpreis inkl. USt.:</label>
                    {{ form_widget(form.price, { 'attr': { 'placeholder': '0', 'class': 'small-input' } }) }}EUR
                    <div class="err-msg">{{ form_errors(form.price) }}</div>
                </div>
            {% endif %}
        </div>
    </div>
    <div class="row answer">
        <div class="col-xs-12">
           <!-- <h1>Nachricht an {% if inquiry.user %}{{ inquiry.user.name }}{% else %}{{ inquiry.name }}{% endif %}</h1> -->
            <p class="text-bold">Deine Telefon Nr. für Rückfragen: +43 {{ talent.user.fullPhone }} 
                {# TODO: add modal to update phone number
                    <a href="" data-toggle="modal" data-target=".phone">editieren</a> #}
            </p>
        </div>
    </div>
    <div class="row bewertung-request-form">
        <div class="col-xs-12">
            {% set ph = "Möchtest du " ~ inquiry.user.name ~ " etwas mitteilen? Falls die Buchungsdaten für dich nicht passen, kannst du die Anfrage ablehnen und " ~ inquiry.user.name ~ " bitten mit neuen Buchungsdaten anzufragen." %}
            {{ form_widget(form.response, { 'attr': { 'placeholder': ph } }) }}
            <button id="response-submit">Absenden</button>
        </div>
    </div>
    {{ form_end(form) }}
    <div class="row user-answer">
        <div class="col-xs-12">
            <h2>Anfrage</h2>
            <div class="row">
                <div class="col-sm-2 col-xs-4 user">
                    {% if inquiry.user %}
                        <img src="{{ inquiry.user.getProfilePicture(false, image_url_prefix) }}" alt=""/>
                    {% endif %}
                    <p>{% if inquiry.user %}{{ inquiry.user.name }}{% else %}{{ inquiry.name }}{% endif %}</p>
                    {% if inquiry.user.rating %}
                        {{ include('common/stars.html.twig', { rating: inquiry.user.rating }) }}
                    {% endif %}
                </div>
                <div class="col-sm-10 col-xs-8 question-content">
                    <p class="text-italic">
                        {{ inquiry.message|nl2br }}
                    </p>
                    <div class="question-data">
                        <p class="text-bold"><strong>Buchungsdaten:</strong></p>
                        <p class="text-bold"><strong>{{ talent.name }}</strong></p>                        
                        {% if inquiry.type == constant('AppBundle\\Entity\\TariffType::EINZELSTUNDEN') %}
                            <p class="no-margin-bottom"><strong>Beginn:</strong> {{ inquiry.fromAt|localizeddate('none', 'none', 'de_AT', null, 'cccc dd MMMM yyyy, HH:mm') }}</p>
                            <p class="no-margin-bottom"><strong>Ende:</strong> {{ inquiry.toAt|localizeddate('none', 'none', 'de_AT', null, 'cccc dd MMMM yyyy, HH:mm') }}</p>
                        {% elseif inquiry.type in [constant('AppBundle\\Entity\\TariffType::WORKSHOP'), constant('AppBundle\\Entity\\TariffType::GRUPPENSTUNDEN')] %}
                            <p class="no-margin-bottom"><strong>Termin:</strong> {{ inquiry.fromAt|localizeddate('none', 'none', 'de_AT', null, 'cccc dd MMMM yyyy') }}</p>
                        {% elseif inquiry.type == constant('AppBundle\\Entity\\TariffType::TAGESSATZ') %}
                            <p class="no-margin-bottom"><strong>Beginn:</strong> {{ inquiry.fromAt|localizeddate('none', 'none', 'de_AT', null, 'cccc dd MMMM yyyy') }}</p>
                            <p class="no-margin-bottom"><strong>Ende:</strong> {{ inquiry.toAt|localizeddate('none', 'none', 'de_AT', null, 'cccc dd MMMM yyyy') }}</p>
                        {% endif %}                        
                        <p class="no-margin-bottom"><strong>Dein Verdienst:</strong> {% if talent.requestPrice == 1 %}auf&nbsp;Anfr.{% else %}{{ inquiry.price|number_format(2, ',') }} €{% endif %}</p>
                            {# TODO: add modal to update address 
                            (<a href="" data-toggle="modal" data-target=".anfrage">editieren</a>)</p> #}
                        <p class="last">Buchungsnr.: T-{{ inquiry.id }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <span class="add-margin-bottom-300"></span>
  </div>
  </div>
  <div id="allge-modal" class="modal fade anfrage register" role="dialog">
      <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
              <div class="modal-header ort form-container">
                  <button type="button" class="close" data-dismiss="modal"><img src="/img/close-modal.png" alt="close"/></button>
                  <h4 class="modal-title">Angebot Adresse bearbeiten</h4>
                  <div class="row">
                    <div class="col-xs-8">
                      <input type="text" placeholder="Strasse*" />
                    </div>
                    <div class="col-xs-4">
                      <input type="text" placeholder="Hausnr.*" />
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-xs-3">
                      <input type="text" placeholder="Plz*" />
                    </div>
                    <div class="col-xs-5">
                      <input type="text" placeholder="Ort*" />
                    </div>
                  </div>
                  <button type="button" class="sp">Speichern</button>
          </div>
      </div>
  </div>
</div>
  <div id="phone-modal" class="modal fade phone register" role="dialog">
      <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
              <div class="modal-header form-container">
                  <button type="button" class="close" data-dismiss="modal"><img src="/img/close-modal.png" alt="close"/></button>
                  <h4 class="modal-title">Telefon Nr. für User-Rückfragen bearbeiten</h4>
                  <div class="phone-inputs">
                    <span>+43</span><input type="number" maxlength="3" min="0" placeholder="664" />
                    <input type="number" maxlength="7" min="0" placeholder="1808021" />
                    <button type="button" class="sp">Speichern</button>
                  </div>
          </div>
      </div>
  </div>
</div>
  {# todo: add ratings and link #}
  <div id="bewertungen-modal" class="modal fade bewertungen register" role="dialog">
      <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
              <div class="modal-header form-container">
                <button type="button" class="close" data-dismiss="modal"><img src="/img/close-modal.png" alt="close"/></button>
                <h4 class="modal-title">Bewertungen für Ilse</h4>
                <div class="row">
                  <div class="col-xs-4 mark">
                    <ul>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                    </ul>
                    <p>
                      Hast du ein tolles Produkt, benötigst für deine Anzeige aber Hilfe, mit denProduktfotos? Dann kannst du unseren Photoservice in Anspruch nehmen. Schreib uns dazu an support@heysharing.com
                    </p>
                  </div>
                  <div class="col-xs-4 mark">
                    <ul>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                    </ul>
                    <p>
                      Hast du ein tolles Produkt, benötigst für deine Anzeige aber Hilfe, mit denProduktfotos? Dann kannst du unseren Photoservice in Anspruch nehmen. Schreib uns dazu an support@heysharing.com
                    </p>
                  </div>
                  <div class="col-xs-4 mark">
                    <ul>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                    </ul>
                    <p>
                      Hast du ein tolles Produkt, benötigst für deine Anzeige aber Hilfe, mit denProduktfotos? Dann kannst du unseren Photoservice in Anspruch nehmen. Schreib uns dazu an support@heysharing.com
                    </p>
                  </div>
                  <div class="col-xs-4 mark">
                    <ul>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                    </ul>
                    <p>
                      Hast du ein tolles Produkt, benötigst für deine Anzeige aber Hilfe, mit denProduktfotos? Dann kannst du unseren Photoservice in Anspruch nehmen. Schreib uns dazu an support@heysharing.com
                    </p>
                  </div>
                  <div class="col-xs-4 mark">
                    <ul>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                    </ul>
                    <p>
                      Hast du ein tolles Produkt, benötigst für deine Anzeige aber Hilfe, mit denProduktfotos? Dann kannst du unseren Photoservice in Anspruch nehmen. Schreib uns dazu an support@heysharing.com
                    </p>
                  </div>
                  <div class="col-xs-4 mark">
                    <ul>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="marked glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                        <li><span class="glyphicon glyphicon-star"></span></li>
                    </ul>
                    <p>
                      Hast du ein tolles Produkt, benötigst für deine Anzeige aber Hilfe, mit denProduktfotos? Dann kannst du unseren Photoservice in Anspruch nehmen. Schreib uns dazu an support@heysharing.com
                    </p>
                  </div>
                </div>
          </div>
      </div>
  </div>
</div>
  
  
  {% if saved %}
  <div id="question-modal" class="modal fade delete-offer" role="dialog">
      <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
              <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal"><img src="/img/close-modal.png" alt="close"/></button>
      <div class="content-modal">
        {% if decision > 0 %}
		<p class="text-bold">Anfrage abgelehnt</p>
		<p class="delate-info">Die Anfrage wurde auf deinen Wunsch abgelehnt. Wir haben dir eine Bestätigung per Email geschickt.</p>
		{% else %}
		<p class="text-bold">Vielen Dank!</p>
        <p class="delate-info">Du hast die Anfrage erfolgreich angenommen! Wir haben dir eine Bestätigung per Email geschickt.</p>
		 {% endif %}
              </div>
          </div>
      </div>
  </div>
  {% endif %}
  
  {% endblock %}
  
  {% block script %}
  <script>
        $(function(){
            $("#response-submit").click(function() {
                var form = document.getElementById('response');
                if (form.checkValidity())
                    form.submit();
            });
            {% if saved %}
                $("#question-modal").modal();                
                $("#question-modal").on("hidden.bs.modal", function(){ 
                    window.location = '{{ path('dashboard') }}';
                });
            {% endif %}            
        });
      
  </script>  
{% endblock %}